# src/services/external_api.py

def mock_external_api_call(user_query: str) -> list[dict]:
    """
    Имитирует вызов внешнего API и возвращает список документов.
    В реальном приложении здесь будет HTTP-запрос с помощью requests.
    """
    print(f"--- Имитация вызова внешнего API для запроса: '{user_query}' ---")
    
    # Пример данных, как в ТЗ
    sample_data = [
        {
            "doc_id": "85_662793",
            "title": "Как заполнить заявление по форме № Р13014 при смене директор",
            "score": 0.99758,
            "paragraph": "Как заполнить заявление по форме № Р13014 при смене директор. Назначить новым директором можно как гражданина РФ, так и иностранца. Подать документы в ФНС нужно в течение семи дней после того, как приняли решение сменить руководителя. За нарушение сроков новому директору грозит предупреждение или штраф – 5 тыс. руб."
        },
        {
            "doc_id": "86_558385",
            "title": "Как уведомить налоговую инспекцию о смене генерального директора",
            "score": 0.98123,
            "paragraph": "Срок уведомления налоговой инспекции о смене директора составляет семь рабочих дней с момента принятия соответствующего решения. Уведомление происходит путем подачи заявления по форме № Р13014. Заявителем выступает новый генеральный директор."
        },
        {
            "doc_id": "12_788389",
            "title": "Ответственность за несвоевременное уведомление о смене юр адреса",
            "score": 0.85432,
            "paragraph": "Если не уведомить регистрирующий орган об изменениях вовремя, это может повлечь за собой административную ответственность. Штраф для должностных лиц составляет от 5 000 до 10 000 рублей."
        }
    ]
    return sample_data

def format_docs_for_prompt(docs: list[dict]) -> str:
    """Форматирует список документов в строку для первого промта."""
    formatted_list = []
    for doc in docs:
        formatted_list.append(
            f"номер документа: {doc['doc_id']}\n"
            f"заголовок: {doc['title']}\n"
            f"абзац: {doc['paragraph']}\n"
        )
    return "\n".join(formatted_list)